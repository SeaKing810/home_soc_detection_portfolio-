rules:
  - rule_id: SOC001
    title: Suspicious PowerShell command line patterns
    severity: high
    mitre_techniques:
      - T1059.001
    kind: powershell_suspicious
    params:
      command_substrings:
        - " -enc "
        - "frombase64string"
        - "iex"
        - "invoke-expression"
        - "downloadstring"
        - "new-object net.webclient"

  - rule_id: SOC002
    title: Failed logon burst from single source IP
    severity: medium
    mitre_techniques:
      - T1110
    kind: failed_logon_burst
    params:
      threshold: 6
      window_seconds: 90

  - rule_id: SOC003
    title: SMB connection with suspicious parent process hint
    severity: low
    mitre_techniques:
      - T1021.002
    kind: unexpected_admin_share_access_hint
    params:
      parent_process_substrings:
        - "winword"
        - "excel"
        - "outlook"
